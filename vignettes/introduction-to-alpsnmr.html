<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Sergio Oller, Institute for Bioengineering of Catalonia" />

<meta name="date" content="2019-05-08" />

<title>Introduction to AlpsNMR</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to AlpsNMR</h1>
<h4 class="author"><em>Sergio Oller, Institute for Bioengineering of Catalonia</em></h4>
<h4 class="date"><em>2019-05-08</em></h4>


<div id="TOC">
<ul>
<li><a href="#enable-parallellization">Enable parallellization</a></li>
<li><a href="#data-the-meoh_serum_extraction-dataset">Data: The <code>MeOH_serum_extraction</code> dataset</a></li>
<li><a href="#loading-samples">Loading samples</a></li>
<li><a href="#adding-metadata">Adding metadata</a></li>
<li><a href="#interpolation">Interpolation</a></li>
<li><a href="#plotting-samples">Plotting samples</a><ul>
<li><a href="#creating-interactive-plots">Creating interactive plots</a></li>
</ul></li>
<li><a href="#exclude-regions">Exclude regions</a></li>
<li><a href="#filter-samples">Filter samples</a></li>
<li><a href="#robust-pca-for-outlier-detection">Robust PCA for outlier detection</a></li>
<li><a href="#peak-detection">Peak detection</a></li>
<li><a href="#spectra-alignment">Spectra alignment</a></li>
<li><a href="#normalization">Normalization</a></li>
<li><a href="#peak-integration">Peak integration</a><ul>
<li><a href="#integration-based-on-peak-center-and-width">1. Integration based on peak center and width</a></li>
<li><a href="#integration-based-on-peak-boundaries">2. Integration based on peak boundaries</a></li>
</ul></li>
<li><a href="#identification">Identification</a></li>
<li><a href="#free-experimentation">Free experimentation</a><ul>
<li><a href="#getting-the-spectra-and-manipulating-it-manually">Getting the spectra and manipulating it manually</a></li>
<li><a href="#creating-an-nmr_dataset_1d-object-from-a-matrix">Creating an <code>nmr_dataset_1D</code> object from a matrix</a></li>
</ul></li>
<li><a href="#final-thoughts">Final thoughts</a></li>
</ul>
</div>

<p>The <code>AlpsNMR</code> package was written with two purposes in mind:</p>
<ul>
<li>to help <strong>data analysts and NMR scientists</strong> to work with NMR samples.</li>
<li>to help <strong>IT pipeline builders</strong> implement automated methods for preprocessing.</li>
</ul>
<p>Functions from this package written for data analysts and NMR scientists are prefixed with <code>nmr_</code>, while higher level functions written for IT pipeline builders are prefixed with <code>pipe_</code>.</p>
<p>This vignette is written for the first group. It assumes some prior basic knowledge of NMR and data analysis, as well as some basic R programming. In case you are interested in building pipelines with this package, you may want to open the file saved in this directory (run it on your computer):</p>
<pre><code>pipeline_example &lt;- system.file(&quot;pipeline-rmd&quot;, &quot;pipeline_example.R&quot;, package = &quot;AlpsNMR&quot;)
print(pipeline_example)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(AlpsNMR)
<span class="kw">library</span>(ggplot2)</code></pre></div>
<div id="enable-parallellization" class="section level1">
<h1>Enable parallellization</h1>
<p>This package is able to parallellize several functions through the use of the <code>future</code> and <code>furrr</code> packages. Whether to parallelize or not is left to the user that can control the parallellization by setting “plans”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#plan(sequential()) # disable parallellization (default)</span>
<span class="kw">plan</span>(<span class="kw">multiprocess</span>(<span class="dt">workers =</span> <span class="dv">4</span>)) <span class="co"># enable parallellization with 4 workers</span></code></pre></div>
</div>
<div id="data-the-meoh_serum_extraction-dataset" class="section level1">
<h1>Data: The <code>MeOH_serum_extraction</code> dataset</h1>
<p>To explore the basics of the AlpsNMR package, we have included four NMR samples in Bruker format bundled with the package. The samples are (c) Nestlé Institute of Health Sciences and should not be redistributed without NIHS written consent, in case this package was ever published.</p>
<p>If you have installed this package, you can obtain the directory where the four samples are with the command</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MeOH_serum_extraction_dir &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;dataset-demo&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;AlpsNMR&quot;</span>)
<span class="kw">print</span>(MeOH_serum_extraction_dir)
<span class="co">#&gt; [1] &quot;C:/Users/fmadrid/Documents/IBEC/NESTLE/code/AlpsNMR-master/inst/dataset-demo&quot;</span></code></pre></div>
<p>The demo directory includes four samples (zipped) and a dummy Excel metadata file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fs<span class="op">::</span><span class="kw">dir_ls</span>(MeOH_serum_extraction_dir)
<span class="co">#&gt; C:/Users/fmadrid/Documents/IBEC/NESTLE/code/AlpsNMR-master/inst/dataset-demo/10.zip</span>
<span class="co">#&gt; C:/Users/fmadrid/Documents/IBEC/NESTLE/code/AlpsNMR-master/inst/dataset-demo/20.zip</span>
<span class="co">#&gt; C:/Users/fmadrid/Documents/IBEC/NESTLE/code/AlpsNMR-master/inst/dataset-demo/30.zip</span>
<span class="co">#&gt; C:/Users/fmadrid/Documents/IBEC/NESTLE/code/AlpsNMR-master/inst/dataset-demo/40.zip</span>
<span class="co">#&gt; C:/Users/fmadrid/Documents/IBEC/NESTLE/code/AlpsNMR-master/inst/dataset-demo/dummy_metadata.xlsx</span>
<span class="co">#&gt; C:/Users/fmadrid/Documents/IBEC/NESTLE/code/AlpsNMR-master/inst/dataset-demo/README.txt</span></code></pre></div>
<p>Given the name of the dataset, one may guess that the dataset was used to check the Methanol extraction in serum samples. The dummy metadata consists of dummy information, just for the sake of showing how this package can integrate external metadata. The excel file consists of two tidy tables, in two sheets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MeOH_serum_extraction_xlsx &lt;-<span class="st"> </span><span class="kw">file.path</span>(MeOH_serum_extraction_dir, <span class="st">&quot;dummy_metadata.xlsx&quot;</span>)
exp_subj_id &lt;-<span class="st"> </span>readxl<span class="op">::</span><span class="kw">read_excel</span>(MeOH_serum_extraction_xlsx, <span class="dt">sheet =</span> <span class="dv">1</span>)
subj_id_age &lt;-<span class="st"> </span>readxl<span class="op">::</span><span class="kw">read_excel</span>(MeOH_serum_extraction_xlsx, <span class="dt">sheet =</span> <span class="dv">2</span>)
<span class="kw">print</span>(exp_subj_id)
<span class="co">#&gt; # A tibble: 4 x 3</span>
<span class="co">#&gt;   NMRExperiment SubjectID TimePoint</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;     &lt;chr&gt;    </span>
<span class="co">#&gt; 1 10            Ana       baseline </span>
<span class="co">#&gt; 2 20            Ana       3 months </span>
<span class="co">#&gt; 3 30            Elia      baseline </span>
<span class="co">#&gt; 4 40            Elia      3 months</span>
<span class="kw">print</span>(subj_id_age)
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   SubjectID   Age</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Ana          29</span>
<span class="co">#&gt; 2 Elia          0</span></code></pre></div>
</div>
<div id="loading-samples" class="section level1">
<h1>Loading samples</h1>
<p>The function to read samples is called <code>nmr_read_samples</code>. It expects a character vector with the samples to load that can be paths to directories of Bruker format samples or paths to JDX files.</p>
<p>Additionally, this function can filter by pulse sequences (e.g. load only NOESY samples) or loading only metadata.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zip_files &lt;-<span class="st"> </span>fs<span class="op">::</span><span class="kw">dir_ls</span>(MeOH_serum_extraction_dir, <span class="dt">glob =</span> <span class="st">&quot;*.zip&quot;</span>)
<span class="kw">print</span>(zip_files)
<span class="co">#&gt; C:/Users/fmadrid/Documents/IBEC/NESTLE/code/AlpsNMR-master/inst/dataset-demo/10.zip</span>
<span class="co">#&gt; C:/Users/fmadrid/Documents/IBEC/NESTLE/code/AlpsNMR-master/inst/dataset-demo/20.zip</span>
<span class="co">#&gt; C:/Users/fmadrid/Documents/IBEC/NESTLE/code/AlpsNMR-master/inst/dataset-demo/30.zip</span>
<span class="co">#&gt; C:/Users/fmadrid/Documents/IBEC/NESTLE/code/AlpsNMR-master/inst/dataset-demo/40.zip</span>
dataset &lt;-<span class="st"> </span><span class="kw">nmr_read_samples</span>(<span class="dt">sample_names =</span> zip_files)
<span class="kw">print</span>(dataset)
<span class="co">#&gt; An nmr_dataset (4 samples)</span></code></pre></div>
<p>As we have not added any metadata to this dataset, the only column we see is the <code>NMRExperiment</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nmr_meta_get</span>(dataset, <span class="dt">groups =</span> <span class="st">&quot;external&quot;</span>)
<span class="co">#&gt; # A tibble: 4 x 1</span>
<span class="co">#&gt;   NMRExperiment</span>
<span class="co">#&gt;   &lt;chr&gt;        </span>
<span class="co">#&gt; 1 10           </span>
<span class="co">#&gt; 2 20           </span>
<span class="co">#&gt; 3 30           </span>
<span class="co">#&gt; 4 40</span></code></pre></div>
</div>
<div id="adding-metadata" class="section level1">
<h1>Adding metadata</h1>
<p>Initally our dataset only has the <code>NMRExperiment</code> column:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nmr_meta_get</span>(dataset, <span class="dt">groups =</span> <span class="st">&quot;external&quot;</span>)
<span class="co">#&gt; # A tibble: 4 x 1</span>
<span class="co">#&gt;   NMRExperiment</span>
<span class="co">#&gt;   &lt;chr&gt;        </span>
<span class="co">#&gt; 1 10           </span>
<span class="co">#&gt; 2 20           </span>
<span class="co">#&gt; 3 30           </span>
<span class="co">#&gt; 4 40</span></code></pre></div>
<p>The <code>exp_subj_id</code> table we loaded links the <code>NMRExperiment</code> to the <code>SubjectID</code>.</p>
<p>As we already have the <code>NMRExperiment</code> column, we can use it as the merging column (note that both columns have the same column name to match the metadata such as group class, age, BMI…):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dataset &lt;-<span class="st"> </span><span class="kw">nmr_meta_add</span>(dataset, <span class="dt">metadata =</span> exp_subj_id, <span class="dt">by =</span> <span class="st">&quot;NMRExperiment&quot;</span>)
<span class="kw">nmr_meta_get</span>(dataset, <span class="dt">groups =</span> <span class="st">&quot;external&quot;</span>)
<span class="co">#&gt; # A tibble: 4 x 3</span>
<span class="co">#&gt;   NMRExperiment SubjectID TimePoint</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;     &lt;chr&gt;    </span>
<span class="co">#&gt; 1 10            Ana       baseline </span>
<span class="co">#&gt; 2 20            Ana       3 months </span>
<span class="co">#&gt; 3 30            Elia      baseline </span>
<span class="co">#&gt; 4 40            Elia      3 months</span></code></pre></div>
<p>If we have info from different files we can match them. For instance, now we have the <code>SubjectID</code> information so we can add the table that adds the <code>SubjectID</code> to the <code>Age</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dataset &lt;-<span class="st"> </span><span class="kw">nmr_meta_add</span>(dataset, <span class="dt">metadata =</span> subj_id_age, <span class="dt">by =</span> <span class="st">&quot;SubjectID&quot;</span>)
<span class="kw">nmr_meta_get</span>(dataset, <span class="dt">groups =</span> <span class="st">&quot;external&quot;</span>)
<span class="co">#&gt; # A tibble: 4 x 4</span>
<span class="co">#&gt;   NMRExperiment SubjectID TimePoint   Age</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1 10            Ana       baseline     29</span>
<span class="co">#&gt; 2 20            Ana       3 months     29</span>
<span class="co">#&gt; 3 30            Elia      baseline      0</span>
<span class="co">#&gt; 4 40            Elia      3 months      0</span></code></pre></div>
<p>Now we have our metadata integrated in the dataset and we can make use of it in further data analysis steps.</p>
</div>
<div id="interpolation" class="section level1">
<h1>Interpolation</h1>
<p>1D NMR samples can be interpolated together, in order to arrange all the spectra into a matrix, with one row per sample. The main parameters we would need is the range of ppm values that we want to interpolate and the resolution.</p>
<p>We can see the ppm resolution by looking at the ppm axis of one sample:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ppm_res &lt;-<span class="st"> </span><span class="kw">nmr_ppm_resolution</span>(dataset)[[<span class="dv">1</span>]]
<span class="kw">message</span>(<span class="st">&quot;The ppm resolution is: &quot;</span>, <span class="kw">format</span>(ppm_res, <span class="dt">digits =</span> <span class="dv">2</span>), <span class="st">&quot; ppm&quot;</span>)
<span class="co">#&gt; The ppm resolution is: 0.00023 ppm</span></code></pre></div>
<p>We can interpolate the dataset, obtaining an <code>nmr_dataset_1D</code> object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dataset &lt;-<span class="st"> </span><span class="kw">nmr_interpolate_1D</span>(dataset, <span class="dt">axis =</span> <span class="kw">c</span>(<span class="dt">min =</span> <span class="op">-</span><span class="fl">0.5</span>, <span class="dt">max =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">2.3E-4</span>))</code></pre></div>
<p>This operation changes the class of the object, as now the data is on a matrix. The dataset is now of class <code>nmr_dataset_1D</code>. The <code>axis</code> element is now a numeric vector and the <code>data_1r</code> element is a matrix.</p>
</div>
<div id="plotting-samples" class="section level1">
<h1>Plotting samples</h1>
<p>The <code>AlpsNMR</code> package offers the possibility to plot <code>nmr_dataset_1D</code> objects. Plotting many spectra with so many points is quite expensive so it is possible to include only some regions of the spectra or plot only some samples.</p>
<p>Use <code>?plot.nmr_dataset_1D</code> to check the parameters, among them:</p>
<ul>
<li><code>NMRExperiment</code>: A character vector with the NMR experiments to plot</li>
<li><code>chemshift_range</code>: A ppm range to plot only a small region, or to reduce the resolution</li>
<li><code>interactive</code>: To make the plot interactive</li>
<li><code>...</code>: Can be used to pass additional parameters such as <code>color = &quot;SubjectID&quot;</code> that are passed as aesthetics to ggplot.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(dataset, <span class="dt">NMRExperiment =</span> <span class="kw">c</span>(<span class="st">&quot;10&quot;</span>, <span class="st">&quot;30&quot;</span>), <span class="dt">chemshift_range =</span> <span class="kw">c</span>(<span class="fl">2.2</span>, <span class="fl">2.8</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="creating-interactive-plots" class="section level2">
<h2>Creating interactive plots</h2>
<p>The option <code>interactive = TRUE</code> described above has some performance limitations. As high performance workaround, you can make many plots interactive with the function <code>plot_interactive</code>.</p>
<p>This function will use WebGL technologies to create a webpage that, once opened, allows you to interact with the plot.</p>
<p>Due to technical limitations, these plots need to be opened manually and can’t be embedded in RMarkdown documents. Therefore, the function saves the plot in the directory for further exploration. Additionally, some old web browsers may not be able to display these interactive plots correctly.</p>
<pre><code>plt &lt;- plot(dataset, NMRExperiment = c(&quot;10&quot;, &quot;30&quot;), chemshift_range = c(2.2, 2.8))
plot_interactive(plt, &quot;plot_region.html&quot;)</code></pre>
</div>
</div>
<div id="exclude-regions" class="section level1">
<h1>Exclude regions</h1>
<p>Some regions can easily be excluded from the spectra with <code>nmr_exclude_region</code>. Note that the regions are fully removed and not zeroed, as using zeros complicates a lot the implementation<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> and has little advantages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">regions_to_exclude &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">water =</span> <span class="kw">c</span>(<span class="fl">4.6</span>, <span class="dv">5</span>), <span class="dt">methanol =</span> <span class="kw">c</span>(<span class="fl">3.33</span>, <span class="fl">3.39</span>))
dataset &lt;-<span class="st"> </span><span class="kw">nmr_exclude_region</span>(dataset, <span class="dt">exclude =</span> regions_to_exclude)
<span class="kw">plot</span>(dataset, <span class="dt">chemshift_range =</span> <span class="kw">c</span>(<span class="fl">4.2</span>, <span class="fl">5.5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="filter-samples" class="section level1">
<h1>Filter samples</h1>
<p>Maybe we just want to analyze a subset of the data, e.g., only a class group or a particular gender. We can filter some samples according to their metadata as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">samples_10_<span class="dv">20</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(dataset, SubjectID <span class="op">==</span><span class="st"> &quot;Ana&quot;</span>)
<span class="kw">nmr_meta_get</span>(samples_10_<span class="dv">20</span>, <span class="dt">groups =</span> <span class="st">&quot;external&quot;</span>)
<span class="co">#&gt; # A tibble: 2 x 4</span>
<span class="co">#&gt;   NMRExperiment SubjectID TimePoint   Age</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt; 1 10            Ana       baseline     29</span>
<span class="co">#&gt; 2 20            Ana       3 months     29</span></code></pre></div>
</div>
<div id="robust-pca-for-outlier-detection" class="section level1">
<h1>Robust PCA for outlier detection</h1>
<p>The AlpsNMR package includes robust PCA analysis for outlier detection. With such a small demo dataset, it is not practical to use, but check out the documentation of <code>nmr_pca_outliers_*</code> functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pca_outliers_rob &lt;-<span class="st"> </span><span class="kw">nmr_pca_outliers_robust</span>(dataset, <span class="dt">ncomp =</span> <span class="dv">3</span>)
<span class="kw">nmr_pca_outliers_plot</span>(dataset, pca_outliers_rob)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> # Baseline removal</p>
<p>Spectra may display an unstable baseline, specially when processing blood/fecal blood/fecal samples. If so, <code>nmr_baseline_removal</code> subtract the baseline by means of Asymmetric Least Squares method.</p>
<p>See before:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(dataset, <span class="dt">chemshift_range =</span> <span class="kw">c</span>(<span class="fl">3.5</span>,<span class="fl">3.8</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>And after:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dataset =<span class="st"> </span><span class="kw">nmr_baseline_removal</span>(dataset, <span class="dt">lambda =</span> <span class="dv">6</span>, <span class="dt">p =</span> <span class="fl">0.01</span>)
<span class="kw">plot</span>(dataset, <span class="dt">chemshift_range =</span> <span class="kw">c</span>(<span class="fl">3.5</span>,<span class="fl">3.8</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="peak-detection" class="section level1">
<h1>Peak detection</h1>
<p>The peak detection is performed on short spectra segments using a continuous wavelet transform. See <code>?nmr_detect_peaks</code> for more information.</p>
<p>Our current approach relies on the use of the baseline threshold (<code>baselineThresh</code>) automatic calculated (see <code>?nmr_baseline_threshold</code>) and the Signal to Noise Threshold (<code>SNR.Th</code>) to discriminate valid peaks from noise.</p>
<p>The combination of the <code>baselineThresh</code> and the <code>SNR.Th</code> optimizes the number of actual peaks from noise.</p>
<p>The advantage of the <code>SNR.Th</code> method is that it estimates the noise level on each spectra region independently, so in practice it can be used as a dynamic baseline threshold level.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">peak_table &lt;-<span class="st"> </span><span class="kw">nmr_detect_peaks</span>(dataset,
                               <span class="dt">nDivRange_ppm =</span> <span class="fl">0.1</span>,
                               <span class="dt">scales =</span> <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">16</span>, <span class="dv">2</span>),
                               <span class="dt">baselineThresh =</span> <span class="ot">NULL</span>, <span class="dt">SNR.Th =</span> <span class="dv">3</span>)
NMRExp_ref &lt;-<span class="st"> </span><span class="kw">nmr_align_find_ref</span>(dataset, peak_table)
<span class="kw">message</span>(<span class="st">&quot;Your reference is NMRExperiment &quot;</span>, NMRExp_ref)
<span class="co">#&gt; Your reference is NMRExperiment 20</span>
<span class="kw">nmr_detect_peaks_plot</span>(dataset, peak_table, <span class="dt">NMRExperiment =</span> <span class="st">&quot;20&quot;</span>, <span class="dt">chemshift_range =</span> <span class="kw">c</span>(<span class="fl">3.5</span>,<span class="fl">3.8</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="spectra-alignment" class="section level1">
<h1>Spectra alignment</h1>
<p>To align the sample, we use the <code>nmr_align</code> function, which in turn uses a hierarchical clustering method (see <code>?nmr_align</code> for further details).</p>
<p>The <code>maxShift_ppm</code> limits the maximum shift allowed for the spectra.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nmr_exp_ref &lt;-<span class="st"> </span><span class="kw">nmr_align_find_ref</span>(dataset, peak_table)
dataset_align &lt;-<span class="st"> </span><span class="kw">nmr_align</span>(dataset, peak_table, nmr_exp_ref, <span class="dt">maxShift_ppm =</span> <span class="fl">0.0015</span>, <span class="dt">acceptLostPeak =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(dataset, <span class="dt">chemshift_range =</span> <span class="kw">c</span>(<span class="fl">3.025</span>, <span class="fl">3.063</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(dataset_align, <span class="dt">chemshift_range =</span> <span class="kw">c</span>(<span class="fl">3.025</span>, <span class="fl">3.063</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="normalization" class="section level1">
<h1>Normalization</h1>
<p>There are multiple normalization techniques available. The most strongly recommended is the <code>pqn</code> normalization, but it may not be fully reliable when the number of samples is small, as it needs a computation of the median spectra. Nevertheless, it is possible to compute it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dataset_norm &lt;-<span class="st"> </span><span class="kw">nmr_normalize</span>(dataset_align, <span class="dt">method =</span> <span class="st">&quot;pqn&quot;</span>)
<span class="co">#&gt; Warning in norm_pqn(samples[[&quot;data_1r&quot;]]): The Probabalistic Quotient</span>
<span class="co">#&gt; Normalization requires several samples to compute the median spectra. Your</span>
<span class="co">#&gt; number of samples is low</span></code></pre></div>
<p>The <code>AlpsNMR</code> package offers the possibility to extract additional diagnostic information with <code>nmr_diagnose(dataset)</code>. For now, this feature is only used on the normalization to explore the normalization factors applied to each sample:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diagnostic &lt;-<span class="st"> </span><span class="kw">nmr_diagnose</span>(dataset_norm)
<span class="kw">print</span>(diagnostic<span class="op">$</span>norm_factor)
<span class="co">#&gt;   NMRExperiment norm_factor norm_factor_norm</span>
<span class="co">#&gt; 1            10   522485930        0.8705915</span>
<span class="co">#&gt; 2            20   688575310        1.1473377</span>
<span class="co">#&gt; 3            30   598587425        0.9973955</span>
<span class="co">#&gt; 4            40   601713644        1.0026045</span>
<span class="kw">print</span>(diagnostic<span class="op">$</span>plot)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="peak-integration" class="section level1">
<h1>Peak integration</h1>
<div id="integration-based-on-peak-center-and-width" class="section level2">
<h2>1. Integration based on peak center and width</h2>
<p>If we want to integrate the whole spectra, we need ppm from the <code>peak_table</code>. See <code>Peak detection</code> section. The function <code>nmr_integrate_peak_positions</code> generates a new <code>nmr_dataset_1D</code> object containing the integrals from the <code>peak_table</code> (ppm values corresponding to detected peaks).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">peak_table_integration =<span class="st"> </span><span class="kw">nmr_integrate_peak_positions</span>(
  <span class="dt">samples =</span> dataset_norm,
  <span class="dt">peak_pos_ppm =</span> peak_table<span class="op">$</span>ppm,
  <span class="dt">peak_width_ppm =</span> <span class="fl">0.006</span>)

peak_table_integration =<span class="st"> </span><span class="kw">get_integration_with_metadata</span>(peak_table_integration)</code></pre></div>
<p>We can also integrate with a specific peak position and some arbitrary width:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nmr_data</span>(
  <span class="kw">nmr_integrate_peak_positions</span>(<span class="dt">samples =</span> dataset_norm,
                            <span class="dt">peak_pos_ppm =</span> <span class="kw">c</span>(<span class="fl">4.1925</span>, <span class="fl">4.183</span>, <span class="fl">4.1775</span>, <span class="fl">4.17</span>),
                            <span class="dt">peak_width_ppm =</span> <span class="fl">0.006</span>)
)
<span class="co">#&gt;      ppm_4.1925   ppm_4.1830   ppm_4.1775   ppm_4.1700</span>
<span class="co">#&gt; 10 3.190189e-08 3.298304e-08 2.313092e-08 1.339955e-08</span>
<span class="co">#&gt; 20 2.549221e-08 1.779341e-08 1.812701e-08 9.971924e-09</span>
<span class="co">#&gt; 30 2.570141e-08 2.548584e-08 1.910047e-08 8.212517e-09</span>
<span class="co">#&gt; 40 2.655425e-08 3.020573e-08 2.637977e-08 1.838752e-08</span></code></pre></div>
</div>
<div id="integration-based-on-peak-boundaries" class="section level2">
<h2>2. Integration based on peak boundaries</h2>
<p>Imagine we only want to integrate the four peaks corresponding to the pyroglutamic acid:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pyroglutamic_acid_region &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">4.15</span>, <span class="fl">4.20</span>)
<span class="kw">plot</span>(dataset_norm, <span class="dt">chemshift_range =</span> pyroglutamic_acid_region) <span class="op">+</span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggtitle</span>(<span class="st">&quot;Pyroglutamic acid region&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We define the peak regions and integrate them. Note how we can correct the baseline or not. If we correct the baseline, the limits of the integration will be connected with a straight line and that line will be used as the baseline, that will be subtracted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pyroglutamic_acid &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">pyroglutamic_acid1 =</span> <span class="kw">c</span>(<span class="fl">4.19</span>, <span class="fl">4.195</span>),
                          <span class="dt">pyroglutamic_acid2 =</span> <span class="kw">c</span>(<span class="fl">4.18</span>, <span class="fl">4.186</span>),
                          <span class="dt">pyroglutamic_acid3 =</span> <span class="kw">c</span>(<span class="fl">4.175</span>, <span class="fl">4.18</span>),
                          <span class="dt">pyroglutamic_acid4 =</span> <span class="kw">c</span>(<span class="fl">4.165</span>, <span class="fl">4.172</span>))
regions_basel_corr_ds &lt;-<span class="st"> </span><span class="kw">nmr_integrate_regions</span>(dataset_norm, pyroglutamic_acid, <span class="dt">fix_baseline =</span> <span class="ot">TRUE</span>)
regions_basel_corr_matrix &lt;-<span class="st"> </span><span class="kw">nmr_data</span>(regions_basel_corr_ds)
<span class="kw">print</span>(regions_basel_corr_matrix)
<span class="co">#&gt;    pyroglutamic_acid1 pyroglutamic_acid2 pyroglutamic_acid3</span>
<span class="co">#&gt; 10       2.672184e-08       3.298304e-08       2.434264e-08</span>
<span class="co">#&gt; 20       2.157743e-08       1.779341e-08       1.204387e-08</span>
<span class="co">#&gt; 30       2.297715e-08       2.548584e-08       1.821153e-08</span>
<span class="co">#&gt; 40       2.093958e-08       3.020573e-08       2.259284e-08</span>
<span class="co">#&gt;    pyroglutamic_acid4</span>
<span class="co">#&gt; 10       5.572668e-08</span>
<span class="co">#&gt; 20       5.144560e-08</span>
<span class="co">#&gt; 30       5.183817e-08</span>
<span class="co">#&gt; 40       4.803844e-08</span>


regions_basel_not_corr_ds &lt;-<span class="st"> </span><span class="kw">nmr_integrate_regions</span>(dataset_norm, pyroglutamic_acid, <span class="dt">fix_baseline =</span> <span class="ot">FALSE</span>)
regions_basel_not_corr_matrix &lt;-<span class="st"> </span><span class="kw">nmr_data</span>(regions_basel_not_corr_ds)
<span class="kw">print</span>(regions_basel_not_corr_matrix)
<span class="co">#&gt;    pyroglutamic_acid1 pyroglutamic_acid2 pyroglutamic_acid3</span>
<span class="co">#&gt; 10       2.775960e-07       3.327432e-07       2.683463e-07</span>
<span class="co">#&gt; 20       2.727197e-07       3.294237e-07       2.673306e-07</span>
<span class="co">#&gt; 30       2.697318e-07       3.246928e-07       2.622664e-07</span>
<span class="co">#&gt; 40       2.707183e-07       3.289879e-07       2.607063e-07</span>
<span class="co">#&gt;    pyroglutamic_acid4</span>
<span class="co">#&gt; 10       3.765365e-07</span>
<span class="co">#&gt; 20       3.796868e-07</span>
<span class="co">#&gt; 30       3.669548e-07</span>
<span class="co">#&gt; 40       3.705510e-07</span></code></pre></div>
<p>We may plot the integral values to explore variation based on the baseline subtraction.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dplyr<span class="op">::</span><span class="kw">bind_rows</span>(
  regions_basel_corr_matrix <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span>
<span class="st">    </span>tibble<span class="op">::</span><span class="kw">rownames_to_column</span>(<span class="st">&quot;NMRExperiment&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">    </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="st">&quot;metabolite_peak&quot;</span>, <span class="st">&quot;area&quot;</span>, <span class="op">-</span>NMRExperiment) <span class="op">%&gt;%</span>
<span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">BaselineCorrected =</span> <span class="ot">TRUE</span>),
  regions_basel_not_corr_matrix <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span>
<span class="st">    </span>tibble<span class="op">::</span><span class="kw">rownames_to_column</span>(<span class="st">&quot;NMRExperiment&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">    </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="st">&quot;metabolite_peak&quot;</span>, <span class="st">&quot;area&quot;</span>, <span class="op">-</span>NMRExperiment) <span class="op">%&gt;%</span>
<span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">BaselineCorrected =</span> <span class="ot">FALSE</span>)
) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> NMRExperiment, <span class="dt">y =</span> area, <span class="dt">color =</span> metabolite_peak)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>BaselineCorrected)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="identification" class="section level1">
<h1>Identification</h1>
<p>After applying any feature selection or machine learning, Alps allows the identification of features of interest through <code>nmr_identify_regions_blood</code>. The function gives 3 posibilities sorted by the most probable metabolite (see <code>nmr_identify_regions_blood</code> for details).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ppm_to_assign &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">4.060960203</span>, <span class="fl">3.048970634</span>,<span class="fl">2.405935596</span>,<span class="fl">0.990616851</span>,<span class="fl">0.986520147</span>, <span class="fl">1.044258467</span>)
identification &lt;-<span class="st"> </span><span class="kw">nmr_identify_regions_blood</span> (ppm_to_assign)
<span class="co">#&gt; [1] 4.06096</span>
<span class="co">#&gt; your peak at 4.060960203 probably corresponds to Creatinine, Myoinositol or Sucrose</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [1] 3.048971</span>
<span class="co">#&gt; your peak at 3.048970634 probably corresponds to Creatinine, NA or NA</span>
<span class="co">#&gt; [1] 2.405936</span>
<span class="co">#&gt; your peak at 2.405935596 probably corresponds to Pyroglutamic acid, Succinic acid or NA</span>
<span class="co">#&gt; [1] 0.9906169</span>
<span class="co">#&gt; your peak at 0.990616851 probably corresponds to L-Alpha-aminobutyric acid, L-Valine or NA</span>
<span class="co">#&gt; [1] 0.9865201</span>
<span class="co">#&gt; your peak at 0.986520147 probably corresponds to L-Valine, NA or NA</span>
<span class="co">#&gt; [1] 1.044258</span>
<span class="co">#&gt; your peak at 1.044258467 probably corresponds to L-Valine, NA or NA</span></code></pre></div>
</div>
<div id="free-experimentation" class="section level1">
<h1>Free experimentation</h1>
<div id="getting-the-spectra-and-manipulating-it-manually" class="section level2">
<h2>Getting the spectra and manipulating it manually</h2>
<p>Besides all those techniques, you can easily implement your own. You can extract the raw matrix and manipulate it at will. As long as you don’t permute the rows, you can always replace the raw matrix of the <code>nmr_dataset_1D</code> object through the <code>nmr_data</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">full_spectra_matrix &lt;-<span class="st"> </span><span class="kw">nmr_data</span>(dataset)
<span class="kw">print</span>(full_spectra_matrix[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]) <span class="co"># change it as you wish</span>
<span class="co">#&gt;         -0.5  -0.49977   -0.49954  -0.49931  -0.49908  -0.49885</span>
<span class="co">#&gt; 10 1672.0444 1433.8976 1072.32940 1401.1787 1634.7485 1344.6377</span>
<span class="co">#&gt; 20 1927.6172 2056.4906 1848.73786 1584.5820 1970.5705 2469.3993</span>
<span class="co">#&gt; 30 1337.0010 1029.6625  645.62476  641.0098  825.0757  799.6986</span>
<span class="co">#&gt; 40  992.9131  307.3925  -42.01287  185.1322  319.2994  152.4777</span>
<span class="kw">nmr_data</span>(dataset) &lt;-<span class="st"> </span>full_spectra_matrix <span class="co"># Rewrite the matrix</span></code></pre></div>
</div>
<div id="creating-an-nmr_dataset_1d-object-from-a-matrix" class="section level2">
<h2>Creating an <code>nmr_dataset_1D</code> object from a matrix</h2>
<p>You can also create an <code>nmr_dataset_1D</code> object from scratch with the <code>new_nmr_dataset_1D</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nsamp &lt;-<span class="st"> </span><span class="dv">12</span>
npoints &lt;-<span class="st"> </span><span class="dv">20</span>
<span class="co"># Create a random spectra matrix</span>
dummy_ppm_axis &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">0.2</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">length.out =</span> npoints)
dummy_spectra_matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(nsamp<span class="op">*</span>npoints), <span class="dt">nrow =</span> nsamp, <span class="dt">ncol =</span> npoints)
metadata &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">external =</span> <span class="kw">data.frame</span>(<span class="dt">NMRExperiment =</span> <span class="kw">paste0</span>(<span class="st">&quot;Sample&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>),
                                       <span class="dt">DummyClass =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>),
                                       <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>))
your_custom_nmr_dataset_1D &lt;-<span class="st"> </span><span class="kw">new_nmr_dataset_1D</span>(<span class="dt">ppm_axis =</span> dummy_ppm_axis,
                                                 <span class="dt">data_1r =</span> dummy_spectra_matrix,
                                                 <span class="dt">metadata =</span> metadata)
<span class="kw">print</span>(your_custom_nmr_dataset_1D)
<span class="co">#&gt; An nmr_dataset_1D (12 samples)</span>
<span class="kw">plot</span>(your_custom_nmr_dataset_1D) <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Of course those random values don't make much sense...&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="final-thoughts" class="section level1">
<h1>Final thoughts</h1>
<p>This vignette shows many of the features of the package, some features have room for improvement, others are not fully described, and the reader will need to browse the documentation. Hopefully it is a good starting point for using the package.</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>e.g. it can inadvertedly distort the PQN normalization results<a href="#fnref1">↩</a></p></li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
